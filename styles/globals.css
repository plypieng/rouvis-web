@tailwind base;
@tailwind components;
@tailwind utilities;

@keyframes shimmer {
  100% {
    transform: translateX(100%);
  }
}

@layer base {
  :root {
    color-scheme: light;

    --canvas-fog: 46 26% 97%;
    --surface-soil-0: 42 20% 95%;
    --surface-soil-1: 40 22% 98%;
    --surface-soil-2: 38 18% 92%;

    --ink-primary: 28 18% 18%;
    --ink-secondary: 30 11% 33%;
    --ink-tertiary: 30 10% 46%;
    --ink-muted: 32 9% 56%;

    --brand-seedling: 147 53% 33%;
    --brand-waterline: 199 58% 40%;
    --risk-watch: 43 67% 46%;
    --risk-warning: 31 74% 48%;
    --risk-critical: 2 61% 48%;
    --state-success: 147 53% 36%;

    --border-soft: 36 17% 86%;
    --border-strong: 35 19% 75%;
    --control-bg: 39 15% 92%;
    --control-border: 35 16% 80%;

    --background: var(--canvas-fog);
    --foreground: var(--ink-primary);
    --card: var(--surface-soil-1);
    --card-foreground: var(--ink-primary);
    --popover: var(--surface-soil-1);
    --popover-foreground: var(--ink-primary);

    --primary: var(--brand-seedling);
    --primary-foreground: 42 16% 98%;

    --secondary: var(--surface-soil-0);
    --secondary-foreground: var(--ink-secondary);

    --muted: var(--surface-soil-0);
    --muted-foreground: var(--ink-tertiary);

    --accent: var(--surface-soil-2);
    --accent-foreground: var(--ink-primary);

    --destructive: var(--risk-critical);
    --destructive-foreground: 42 16% 98%;

    --border: var(--border-soft);
    --input: var(--control-border);
    --ring: var(--brand-seedling);

    --radius: 0.9rem;
  }

  .dark {
    color-scheme: dark;

    --canvas-fog: 28 11% 10%;
    --surface-soil-0: 30 11% 13%;
    --surface-soil-1: 28 10% 16%;
    --surface-soil-2: 30 10% 20%;

    --ink-primary: 42 18% 92%;
    --ink-secondary: 40 10% 76%;
    --ink-tertiary: 36 9% 66%;
    --ink-muted: 35 8% 57%;

    --brand-seedling: 147 45% 48%;
    --brand-waterline: 198 56% 55%;
    --risk-watch: 43 72% 52%;
    --risk-warning: 31 72% 57%;
    --risk-critical: 3 68% 58%;
    --state-success: 147 48% 50%;

    --border-soft: 30 9% 24%;
    --border-strong: 30 8% 33%;
    --control-bg: 30 11% 18%;
    --control-border: 30 9% 30%;

    --background: var(--canvas-fog);
    --foreground: var(--ink-primary);
    --card: var(--surface-soil-1);
    --card-foreground: var(--ink-primary);
    --popover: var(--surface-soil-1);
    --popover-foreground: var(--ink-primary);

    --primary: var(--brand-seedling);
    --primary-foreground: 28 11% 10%;

    --secondary: var(--surface-soil-0);
    --secondary-foreground: var(--ink-secondary);

    --muted: var(--surface-soil-0);
    --muted-foreground: var(--ink-tertiary);

    --accent: var(--surface-soil-2);
    --accent-foreground: var(--ink-primary);

    --destructive: var(--risk-critical);
    --destructive-foreground: 42 18% 92%;

    --border: var(--border-soft);
    --input: var(--control-border);
    --ring: var(--brand-seedling);
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html,
  body {
    height: 100%;
  }

  body {
    @apply bg-background text-foreground font-sans antialiased;
    font-feature-settings: "rlig" 1, "calt" 1;
    background-image:
      radial-gradient(circle at 8% 10%, hsl(var(--surface-soil-2) / 0.45), transparent 25%),
      radial-gradient(circle at 84% 0%, hsl(var(--surface-soil-2) / 0.42), transparent 24%);
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply font-heading tracking-tight;
  }
}

@layer utilities {
  .shell-canvas {
    @apply bg-background text-foreground;
  }

  .shell-header {
    @apply border-b border-border/80 bg-card/85 backdrop-blur;
  }

  .shell-footer {
    @apply border-t border-border/80 bg-card/70 backdrop-blur;
  }

  .shell-main {
    @apply mx-auto w-full max-w-[1440px] px-4 sm:px-6 lg:px-8;
  }

  .surface-base {
    @apply rounded-xl border border-border/90 bg-card text-card-foreground;
  }

  .surface-raised {
    @apply rounded-2xl border border-border/95 bg-card text-card-foreground shadow-[0_6px_20px_-16px_rgba(17,24,39,0.45)];
  }

  .surface-overlay {
    @apply rounded-2xl border border-border bg-popover text-popover-foreground shadow-[0_20px_35px_-20px_rgba(17,24,39,0.55)];
  }

  .control-inset {
    @apply rounded-lg border border-input bg-[hsl(var(--control-bg))] text-foreground;
  }

  .status-safe {
    @apply border border-emerald-200/80 bg-emerald-50/80 text-emerald-800 dark:border-emerald-700/60 dark:bg-emerald-900/20 dark:text-emerald-200;
  }

  .status-watch {
    @apply border border-amber-200/80 bg-amber-50/80 text-amber-800 dark:border-amber-700/60 dark:bg-amber-900/20 dark:text-amber-200;
  }

  .status-warning {
    @apply border border-orange-200/80 bg-orange-50/80 text-orange-800 dark:border-orange-700/60 dark:bg-orange-900/20 dark:text-orange-200;
  }

  .status-critical {
    @apply border border-red-200/80 bg-red-50/80 text-red-800 dark:border-red-700/60 dark:bg-red-900/20 dark:text-red-200;
  }

  .glass-panel {
    @apply shell-header;
  }

  .text-balance {
    text-wrap: balance;
  }

  .mobile-viewport {
    @apply min-h-screen;
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-left {
    padding-left: env(safe-area-inset-left);
  }

  .safe-right {
    padding-right: env(safe-area-inset-right);
  }

  .mobile-scroll {
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--border-strong)) transparent;
  }

  .mobile-scroll::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .mobile-scroll::-webkit-scrollbar-thumb {
    background: hsl(var(--border-strong));
    border-radius: 999px;
  }

  .mobile-scroll::-webkit-scrollbar-track {
    background: transparent;
  }

  .mobile-nav-height {
    height: calc(5.25rem + env(safe-area-inset-bottom));
  }

  .touch-target {
    @apply min-h-[44px] min-w-[44px];
  }

  .mobile-tap {
    @apply active:scale-95 transition-transform duration-100;
  }

  .mobile-btn {
    @apply touch-target rounded-lg px-4 py-3 text-base font-medium transition;
  }

  .mobile-btn-primary {
    @apply mobile-btn bg-primary text-primary-foreground hover:opacity-95;
  }

  .mobile-btn-secondary {
    @apply mobile-btn bg-secondary text-secondary-foreground hover:bg-accent;
  }

  .focus-visible:focus-visible {
    @apply outline-none ring-2 ring-ring ring-offset-2 ring-offset-background;
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  .sr-only:focus {
    position: static;
    width: auto;
    height: auto;
    padding: inherit;
    margin: inherit;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }

  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
}

/* ChatKit full-bleed layout overrides
   Apply wrapper class "ck-full-bleed" to the ChatKit container on the page.
   This removes the internal left rail (thread list/sidebar) and forces a one-column layout so the chat fills the card. */
.ck-full-bleed {
  height: 100%;
}

.ck-full-bleed > div {
  height: 100% !important;
  width: 100% !important;
}

.ck-full-bleed > div > div {
  display: grid !important;
  grid-template-columns: 1fr !important;
  gap: 0 !important;
  height: 100% !important;
  max-width: none !important;
  width: 100% !important;
}

.ck-full-bleed > div > div > :first-child {
  display: none !important;
}

.ck-full-bleed [class*="Sidebar"],
.ck-full-bleed [class*="ThreadList"],
.ck-full-bleed [class*="LeftRail"] {
  display: none !important;
}
